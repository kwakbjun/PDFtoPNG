<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF to PNG - Minimal Luxury Edition</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- PDF.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <!-- JSZip -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <!-- FileSaver -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:ital,wght@0,700;1,700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #fcfcfc;
            color: #1a1a1a;
            -webkit-font-smoothing: antialiased;
        }

        h1 {
            font-family: 'Playfair Display', serif;
        }

        .luxury-card {
            background: #ffffff;
            border: 1px solid #eaeaea;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.03);
            transition: transform 0.4s cubic-bezier(0.165, 0.84, 0.44, 1), box-shadow 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
        }

        .drop-zone-area {
            border: 1px solid #e5e7eb;
            background-color: #fafafa;
            transition: all 0.3s ease;
        }

        .drop-zone-area.active {
            border-color: #1a1a1a;
            background-color: #f3f4f6;
        }

        .btn-primary {
            background-color: #1a1a1a;
            color: white;
            transition: all 0.3s ease;
            letter-spacing: 0.05em;
        }

        .btn-primary:hover {
            background-color: #333333;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .btn-secondary {
            border: 1px solid #1a1a1a;
            color: #1a1a1a;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background-color: #f9f9f9;
        }

        /* Custom Progress Bar */
        .progress-fill {
            height: 100%;
            background-color: #1a1a1a;
            transition: width 0.4s ease-out;
        }

        /* Preview Image Animation */
        .preview-item {
            animation: fadeIn 0.8s ease forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Custom Selection */
        ::selection {
            background: #1a1a1a;
            color: white;
        }
    </style>
</head>
<body class="min-h-screen selection:bg-black selection:text-white">

    <div class="max-w-4xl mx-auto px-8 py-20">
        <!-- Header -->
        <header class="text-center mb-24">
            <span class="text-[10px] tracking-[0.3em] font-semibold text-gray-400 uppercase mb-4 block">Professional Utility</span>
            <h1 class="text-5xl md:text-6xl text-gray-900 mb-6 italic">Document Studio</h1>
            <p class="text-gray-500 font-light text-lg tracking-tight">
                PDF 문서를 정교한 고화질 이미지로 변환합니다.<br>
                <span class="text-xs text-gray-300 mt-4 block">PRIVATE & SECURE LOCAL PROCESSING</span>
            </p>
        </header>

        <!-- Main Workspace -->
        <main class="space-y-16">
            <!-- Upload Section -->
            <div class="luxury-card rounded-2xl p-10">
                <div id="drop-zone" class="drop-zone-area relative rounded-xl p-16 text-center cursor-pointer group">
                    <input type="file" id="file-input" accept="application/pdf" class="hidden">
                    
                    <div class="flex flex-col items-center">
                        <svg class="w-12 h-12 text-gray-300 group-hover:text-gray-900 transition-colors mb-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                        </svg>
                        <h3 class="text-lg font-medium text-gray-800 mb-1">문서를 여기에 놓아주세요</h3>
                        <p class="text-xs text-gray-400 font-light tracking-wide">CLICK TO BROWSE OR DRAG PDF</p>
                    </div>
                </div>

                <!-- Config & Progress -->
                <div id="action-area" class="hidden mt-12 space-y-10">
                    <div class="flex flex-col md:flex-row gap-8 items-end justify-between border-t border-gray-100 pt-10">
                        <div class="w-full md:w-1/2">
                            <label class="block text-[10px] font-bold text-gray-400 uppercase mb-3 tracking-widest">Image Fidelity</label>
                            <select id="scale-select" class="w-full bg-white border-b border-gray-200 text-gray-800 py-2 outline-none focus:border-black transition-colors text-sm">
                                <option value="1">Standard (72 DPI)</option>
                                <option value="2" selected>High Definition (144 DPI)</option>
                                <option value="3">Ultra Fine (216 DPI)</option>
                            </select>
                        </div>
                        <div class="w-full md:w-1/2 text-right">
                            <p class="text-[10px] text-gray-400 uppercase font-bold mb-2 tracking-widest">Selected File</p>
                            <p id="file-info" class="text-sm text-gray-800 font-medium truncate italic"></p>
                        </div>
                    </div>

                    <!-- Progress -->
                    <div id="progress-container" class="hidden space-y-3">
                        <div class="flex justify-between items-end">
                            <span id="progress-text" class="text-[10px] font-bold text-gray-400 uppercase tracking-widest">Processing...</span>
                            <span id="progress-percent" class="text-sm font-medium text-gray-900">0%</span>
                        </div>
                        <div class="h-[1px] w-full bg-gray-100">
                            <div id="progress-bar" class="progress-fill" style="width: 0%"></div>
                        </div>
                    </div>

                    <!-- Actions -->
                    <div class="flex flex-col sm:flex-row gap-4 justify-center pt-4">
                        <button id="convert-btn" class="btn-primary text-xs font-bold py-5 px-14 rounded-full uppercase">
                            변환 시작하기
                        </button>
                        <button id="download-zip-btn" class="hidden btn-secondary text-xs font-bold py-5 px-14 rounded-full uppercase">
                            이미지 일괄 저장
                        </button>
                    </div>
                </div>
            </div>

            <!-- Preview Grid -->
            <div id="preview-section" class="hidden space-y-12">
                <div class="flex items-center justify-between border-b border-gray-100 pb-6">
                    <h2 class="text-xs font-bold tracking-[0.2em] text-gray-400 uppercase">변환된 페이지</h2>
                    <span id="page-count-badge" class="text-xs font-medium text-gray-800"></span>
                </div>
                <div id="preview-container" class="grid grid-cols-1 sm:grid-cols-2 gap-12">
                    <!-- Preview cards -->
                </div>
            </div>
        </main>

        <footer class="mt-32 text-center">
            <p class="text-[10px] text-gray-300 tracking-[0.3em] font-medium uppercase">All rights reserved &copy; Document Studio</p>
        </footer>
    </div>

    <!-- Toast -->
    <div id="toast" class="fixed bottom-10 left-1/2 -translate-x-1/2 bg-gray-900 text-white px-8 py-3 rounded-full text-[11px] font-bold tracking-widest uppercase shadow-2xl translate-y-20 opacity-0 transition-all duration-500 z-50">
        Message
    </div>

    <script>
        const pdfjsLib = window['pdfjs-dist/build/pdf'];
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        const dropZone = document.getElementById('drop-zone');
        const fileInput = document.getElementById('file-input');
        const actionArea = document.getElementById('action-area');
        const convertBtn = document.getElementById('convert-btn');
        const downloadZipBtn = document.getElementById('download-zip-btn');
        const previewSection = document.getElementById('preview-section');
        const previewContainer = document.getElementById('preview-container');
        const fileInfoDisplay = document.getElementById('file-info');
        const progressContainer = document.getElementById('progress-container');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        const progressPercent = document.getElementById('progress-percent');
        const pageCountBadge = document.getElementById('page-count-badge');
        const scaleSelect = document.getElementById('scale-select');

        let currentPdf = null;
        let pdfFileName = "";
        let convertedImages = [];

        function showToast(message, isError = false) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.style.backgroundColor = isError ? '#ef4444' : '#1a1a1a';
            toast.classList.remove('translate-y-20', 'opacity-0');
            toast.classList.add('translate-y-0', 'opacity-100');
            setTimeout(() => {
                toast.classList.remove('translate-y-0', 'opacity-100');
                toast.classList.add('translate-y-20', 'opacity-0');
            }, 3000);
        }

        ['dragenter', 'dragover'].forEach(name => {
            dropZone.addEventListener(name, (e) => {
                e.preventDefault();
                dropZone.classList.add('active');
            });
        });

        ['dragleave', 'drop'].forEach(name => {
            dropZone.addEventListener(name, (e) => {
                e.preventDefault();
                dropZone.classList.remove('active');
            });
        });

        dropZone.addEventListener('drop', e => {
            const files = e.dataTransfer.files;
            if (files.length) handleFile(files[0]);
        });

        dropZone.addEventListener('click', () => fileInput.click());
        fileInput.addEventListener('change', e => {
            if (e.target.files.length) handleFile(e.target.files[0]);
        });

        async function handleFile(file) {
            if (file.type !== 'application/pdf') {
                showToast('지원되지 않는 파일 형식입니다.', true);
                return;
            }

            pdfFileName = file.name.replace(/\.[^/.]+$/, "");
            fileInfoDisplay.textContent = file.name;
            actionArea.classList.remove('hidden');
            previewSection.classList.add('hidden');
            downloadZipBtn.classList.add('hidden');
            convertBtn.classList.remove('hidden');
            progressContainer.classList.add('hidden');
            
            const reader = new FileReader();
            reader.onload = async function() {
                try {
                    const typedarray = new Uint8Array(this.result);
                    currentPdf = await pdfjsLib.getDocument(typedarray).promise;
                    showToast(`${currentPdf.numPages}페이지 문서를 불러왔습니다.`);
                } catch (error) {
                    showToast('문서 로드 중 오류가 발생했습니다.', true);
                }
            };
            reader.readAsArrayBuffer(file);
        }

        convertBtn.addEventListener('click', async () => {
            if (!currentPdf) return;

            const totalPages = currentPdf.numPages;
            const scale = parseFloat(scaleSelect.value);
            
            convertBtn.disabled = true;
            convertBtn.classList.add('opacity-30');
            progressContainer.classList.remove('hidden');
            previewSection.classList.remove('hidden');
            previewContainer.innerHTML = '';
            convertedImages = [];
            pageCountBadge.textContent = `${totalPages} Pages`;

            for (let i = 1; i <= totalPages; i++) {
                const percent = Math.round((i / totalPages) * 100);
                progressBar.style.width = `${percent}%`;
                progressText.textContent = `Rendering... (${i}/${totalPages})`;
                progressPercent.textContent = `${percent}%`;

                try {
                    const page = await currentPdf.getPage(i);
                    const viewport = page.getViewport({ scale });
                    
                    const canvas = document.createElement('canvas');
                    const context = canvas.getContext('2d');
                    canvas.height = viewport.height;
                    canvas.width = viewport.width;

                    await page.render({ canvasContext: context, viewport: viewport }).promise;

                    const wrapper = document.createElement('div');
                    wrapper.className = 'preview-item flex flex-col items-center group';
                    
                    const imgContainer = document.createElement('div');
                    imgContainer.className = 'luxury-card rounded-lg overflow-hidden mb-6 bg-white w-full aspect-[3/4] flex items-center justify-center p-4';
                    
                    const img = document.createElement('img');
                    img.src = canvas.toDataURL('image/png');
                    img.className = 'max-w-full max-h-full object-contain shadow-sm';
                    
                    const label = document.createElement('div');
                    label.className = 'text-[10px] font-bold text-gray-300 uppercase tracking-widest';
                    label.textContent = `Page ${i.toString().padStart(2, '0')}`;
                    
                    imgContainer.appendChild(img);
                    wrapper.appendChild(imgContainer);
                    wrapper.appendChild(label);
                    previewContainer.appendChild(wrapper);

                    const blob = await new Promise(res => canvas.toBlob(res, 'image/png'));
                    convertedImages.push({ blob, name: `${pdfFileName}_${i}.png` });

                } catch (err) {
                    console.error(err);
                }
            }

            convertBtn.classList.add('hidden');
            convertBtn.disabled = false;
            convertBtn.classList.remove('opacity-30');
            downloadZipBtn.classList.remove('hidden');
            progressText.textContent = 'Mission Complete';
            showToast('모든 페이지가 변환되었습니다.');
        });

        downloadZipBtn.addEventListener('click', async () => {
            if (convertedImages.length === 0) return;
            const zip = new JSZip();
            convertedImages.forEach(img => zip.file(img.name, img.blob));
            const content = await zip.generateAsync({ type: 'blob' });
            saveAs(content, `${pdfFileName}_package.zip`);
            showToast('파일 저장을 시작합니다.');
        });
    </script>
</body>
</html>